adding departure and arrival time in pathway method, and making it work on global level